# DS-Transaction
## 演进
* 强一致性
```md
单数据库事务
	没有异常提交 出现异常回滚
```
```md
基于后置提交的多数据库事务
	所有数据库操作完成后提交
	可以避免SQL执行异常导致的一致性
	无法避免事务提交出现异常导致的一致性问题
		本质上每一个事务还是单独提交的
```
```md
2PC
	拆分事务提交方式
		prepare 预提交
		commit 确认提交
	问题
		在commit发生异常会导致无法回滚，但发生概率极低
		解决方案
			记录错误日志 定时任务修复
	XA事务
		由X/Open组织提出的分布式事务规范
		工具
			atomikos
```
```md
TCC 编程模式
		解决SOA服务分布式事务一致性
		Try-Commit/Cancel （尝试 确认 取消）
		实现
			SOA服务需要分别实现Try Commit Cancel 接口
		问题
			已有服务已经Commit 后续服务Commit 失败会导致一致性问题
			性能问题 接口调用次数增多
```
> * [MVCC](MVCC.md)
	
* 最终一致性
```md
异步数据补充
方案
	使用消息队列实时触发数据补偿
	使用定时任务周期性触发数据补偿
	也可以结合两种方案 既保证近乎实时一致性 又保证异常情况下的一致性
```
## 权衡
```md
核心流程保证核心数据的实时一致性
非核心数据，通过异步保证一致性
```
## 场景
```md
处理多个数据库之间的数据一致性问题
	一个分布式事务可以看做是多个分布式操作序列组成的，
经典场景：
	跨行转账
```