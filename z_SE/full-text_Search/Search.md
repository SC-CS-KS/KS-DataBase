# 搜索
## 过程
### 1. 用户输入查询语句
### 2. 对查询语句进行词法分析，语法分析，及语言处理
```md
1. 词法分析主要用来识别单词和关键字
2. 语法分析主要是根据查询语句的语法规则来形成一棵语法树
3. 语言处理同索引过程中的语言处理几乎相同。
    如 learned 变成learn等。
```
### 3. 搜索索引，得到符合语法树的文档
```md
1. 查找反向索引表
2. 合并操作
3. 差操作
```
### 4. 根据得到的文档和查询语句的相关性，对结果进行排序
#### 如何计算文档和查询语句的相关性呢？
```md
把查询语句看作一片短小的文档，对文档与文档之间的相关性(relevance)进行打分(scoring)，分数高的相关性好，就应该排在前面。
```
#### 那么又怎么对文档之间的关系进行打分呢？
```md
一个文档有很多词(Term)组成，对于文档之间的关系，不同的Term重要性不同。

判断文档之间的关系，首先找出哪些词(Term)对文档之间的关系最重要。
找出词(Term) 对文档的重要性的过程称为计算词的权重(Term weight) 的过程。
```
##### Term weight
```md
词的权重(Term weight)表示此词(Term)在此文档中的重要程度，越重要的词(Term)有越大的权重(Term weight)，
因而在计算文档之间的相关性中将发挥更大的作用。

判断词(Term) 之间的关系从而得到文档相关性的过程应用一种叫做向量空间模型的算法(Vector Space Model) 。
```
* 影响一个词(Term)在一篇文档中的重要性主要有两个因素：
```md
1. Term Frequency (tf)：即此Term在此文档中出现了多少次。tf 越大说明越重要。
2. Document Frequency (df)：即有多少文档包含Term。df 越大说明越不重要。
```
```md
词(Term)在文档中出现的次数越多，说明此词(Term)对该文档越重要，
如“搜索”这个词，在本文档中出现的次数很多，说明本文档主要就是讲这方面的事的。

然而在一篇英语文档中，this出现的次数更多，就说明越重要吗？
不是的，这是由第二个因素进行调整，第二个因素说明，
有越多的文档包含此词(Term), 说明此词(Term)太普通，不足以区分这些文档，因而重要性越低。
```
##### 向量空间模型的算法(VSM)
```md
把所有此文档中词(term)的权重(term weight) 看作一个向量。
Document = {term1, term2, …… ,term N}
Document Vector = {weight1, weight2, …… ,weight N}
```
```md
同样把查询语句看作一个简单的文档，也用向量来表示。
Query = {term1, term 2, …… , term N}
Query Vector = {weight1, weight2, …… , weight N}
```
```md
把所有搜索出的文档向量及查询向量放到一个N维空间中，每个词(term)是一维。
我们认为两个向量之间的夹角越小，相关性越大。
所以我们计算夹角的余弦值作为相关性的打分，夹角越小，余弦值越大，打分越高，相关性越大。
```

